<!DOCTYPE html>

<html>
<head>
    <title>Zoom test</title>
    <script type="text/javascript" src="scripts/protovis-d.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/yui/2.6.0/build/yahoo-dom-event/yahoo-dom-event.js" type="text/javascript"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/yui/2.6.0/build/connection/connection-min.js" type="text/javascript"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/yui/2.6.0/build/json/json-min.js" type="text/javascript"></script>
    <style type="text/css">

#fig {
  width: 430px;
  height: 425px;
}
body {
  margin: 0;
}
    </style>
  </head>
  
    <body>

haha
<script type="text/javascript" src="scripts/zoom_test.js"></script>
<script type="text/javascript" src="scripts/two_tier_zoom_genome_browser.js"></script>
<script type="text/javascript" src="scripts/miserables.js"></script>
<div id="center">
	<div id="overview"></div>
	<div id="deletionPanel"></div>
</div>

    <script type="text/javascript">
var geneModelData = [{ gene_id: 168, start: 31000, stop: 5800099, name: "ANAC001" },
{ gene_id: 169, start: 3631000, stop: 5899000, name: "ANAC001" }, 
{ gene_id: 913, start: 5928000, stop: 8737000, name: "ARV1" },
{ gene_id: 2295, start: 11649000, stop: 13714000, name: "NGA3" },
{ gene_id: 2295, start: 11111649, stop: 11113714, name: "NGA3" },];


var chr2geneModelDataLsJson = {1: geneModelData};
var deletionData = [
  { row_index: 7, chromosome: 1, start: 5000, stop: 7000, probability: 0.6},
  { row_index: 3, chromosome: 1, start: 8000, stop: 10000, probability: 0.6},
  { row_index: 9, chromosome: 1, start: 12000, stop: 13000, probability: 0.6},
  { row_index: 400, chromosome: 1, start: 12000000, stop: 12000000+130000, probability: 0.6},
];

var data = pv.range(0, 30000000, 20000).map(function(x) {
	return {start: x,
	yStart: (Math.random()*10)};
});

var fullData = {"deletionData":deletionData, "overviewData":data};

var width = 1000;
var overviewHeight = 60;
var imageURL = "/images/";
//var overview = new initializeContexts("overview", "randomData", data, data, width, overviewHeight, imageURL);
var getFrequencyOverviewDataJsonFromTableCNVURL = "/CNV/getFrequencyOverviewDataJsonFromTableCNV?cnv_method_id=20&chromosome=1&smooth_type_id=3";
var getGeneModelDataJsonURL = "/CNV/getGeneModelDataJson?chromosome=1";

/*
var init = new initializeContextsByFetchingData("overview", "randomData", 
	getFrequencyOverviewDataJsonFromTableCNVURL, getGeneModelDataJsonURL,
	width, overviewHeight, imageURL);
*/

/*
if (overviewPanels.length>0){
var fetchURL = "/CNV/getHaplotypeDataJsonFromTableCNVCall?cnv_method_id=16&chromosome=1";
var parentDivID = "overview";

	var widget = new haplotypePanel(parentDivID, "CNV haplotype", fetchURL, null, [], null, null, 0, 1,
			width, 600, imageURL);
	addWidgetAsFocusChildToLastContext(widget);
}
*/
//zoomTest("overview", fullData);

var color = pv.Colors.category19().by(function(d) {return d.group});
 
var vis = new pv.Panel()
    .width(693)
    .height(693)
    .top(90)
    .left(90);
 
var layout = vis.add(pv.Layout.Matrix)
    .nodes(miserables.nodes)
    .links(miserables.links)
    .sort(function(a, b) {return b.group - a.group});
 
layout.link.add(pv.Panel)
	.add(pv.Bar)
	.def("active", -1)
    .fillStyle(function(l) {return l.linkValue
        ? ((l.targetNode.group == l.sourceNode.group)
        ? color(l.sourceNode) : "#555") : "#eee"})
    .antialias(false)
    .lineWidth(1);
    /*
    .anchor("top").add(pv.Label)
    .visible(function() {return this.parent.active()})
    .textStyle("white");
     */
layout.label.add(pv.Label)
    .textStyle(color);
 
vis.render();
    </script>
        
    
</body>
		</html>


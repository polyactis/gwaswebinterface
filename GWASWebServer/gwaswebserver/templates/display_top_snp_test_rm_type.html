<%inherit file="/base.html"/>

<%def name="title()"> Over-representation of candidate genes </%def>

<%def name="displayCommonSetting()">
	<li>
	<b>get_closest=${c.type.get_closest}.</b> 
	% if c.type.get_closest:
		One SNP is classified into candidate gene category if the <b>closest</b> gene within a pre-defined <b>min_distance</b> is a candidate gene.
	% else:
		One SNP is classified into candidate gene category if there are <b>one or more</b> candidate genes within a pre-defined <b>min_distance</b>.
	% endif
	
	</li>
	
	<li>
	<b>allow_two_sample_overlapping=${c.type.allow_two_sample_overlapping}.</b> 
	% if c.type.allow_two_sample_overlapping:
		One SNP is classified into non-candidate gene category if there are both candidate and non-candidate genes within  on either side.
	% else:
		One SNP is <b>NOT</b> classified into non-candidate gene category if there are both candidate and non-candidate genes within a pre-defined <b>min_distance</b> on either side.
	% endif
	</li>
	
	
	<li>
	<b>results_type=${c.type.results_type}.</b> 
	% if c.type.results_type==1:
		The candidate gene category is represented by <b>all</b> SNPs deemed associated with candidate genes.
	% else:
		The candidate gene category is represented by the <b>most significant one</b> among all SNPs deemed associated with candidate genes. The ranks are in reverse order!!
	% endif
	</li>
	
	<li>The minimum MAF(minor allele frequency) for SNPs to be included is ${c.type.min_MAF}.</li>
	
	<li>
	<b>null_distribution_type_id=${c.type.null_distribution_type_id}.</b> 
	The null distribution (that of non-candidate gene) is generated by <b>${c.type.null_distribution_type.short_name}</b>.
	</li>
</%def>


<%def name="displayMatrix(controller='DisplayTopSNPTestRM', action='showOne', figure_type=1, display_thumnail=True)">
	<table border=1>
	
	<tr>
	<th>Candidate Gene List</th>
	
	% for phenotype_label in c.phenotype_info.phenotype_method_label_ls:
		
		<th>${phenotype_label}</th>
	% endfor
	
	</tr>
	
	
	% for i in range(len(c.data_matrix)):
		<tr>
		<td>${c.list_info.list_type_label_ls[i]}</td>
		% for j in range(len(c.data_matrix[0])):
			<td>
			% if c.data_matrix[i][j] is not None:
				% for results_id in c.data_matrix[i][j]:
					<%
					thumbnail_url = h.url(controller='DisplayTopSNPTestRM', action='queryImage', id=results_id[0], type_id=int(c.type.id), list_type_id=c.list_info.list_type_id_ls[i], img_type='png_thumbnail')
					table_url = h.url(controller=controller, action=action, id=results_id[0], type_id=c.type.id, list_type_id=c.list_info.list_type_id_ls[i])
					pvalue_for_enrichment_stat_plot_url = h.url(controller='DisplayTopSNPTestRM', action='queryImage', id=results_id[0], type_id=int(c.type.id), list_type_id=c.list_info.list_type_id_ls[i], img_type='pvalue2D')
					enrichment_stat_curve_plot_url = h.url(controller='DisplayTopSNPTestRM', action='queryImage', id=results_id[0], type_id=int(c.type.id), list_type_id=c.list_info.list_type_id_ls[i], img_type='png_data')
					%>
					<p><a href=${table_url}>${results_id[1]}-${results_id[0]},</a></p>
					
					% if display_thumnail:
						% if figure_type==1:
							<a href=${table_url}><img src=${thumbnail_url}></a>
						% elif figure_type==2:
							<a href=${table_url}><img src=${pvalue_for_enrichment_stat_plot_url} height=600></a>
						% else:
							<a href=${table_url}><img src=${enrichment_stat_curve_plot_url} height=300></a>
						% endif
						
					% endif
				% endfor
			% endif
			</td>
		% endfor
		</tr>
	% endfor
	
	
	</table>
</%def>

<p> ${c.counter} entries In Total.</p>
<ul>

${self.displayCommonSetting()}
</ul>

${self.displayMatrix('DisplayTopSNPTestRM', 'showOne', figure_type=c.figure_type)}
